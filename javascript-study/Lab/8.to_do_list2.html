<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>To-do List</title>
</head>
<body>
  <h1>To-do List</h1>
  <input type="text" id="txt">
  <button id="btnAdd">추가</button>
  <br><br>
  <input type="radio" name="filter" id="filter" value="all" checked> 전체
  <input type="radio" name="filter" id="filter" value="ing"> 진행중
  <input type="radio" name="filter" id="filter" value="complete"> 완료

  <ul id="list"></ul>

  <script>
    // DOM 요소 가져오기
    const txt = document.getElementById("txt");
    const btnAdd = document.getElementById("btnAdd");
    const list = document.getElementById("list");
    const filters = document.querySelectorAll("input[name='filter']");

    // add 이벤트
    function add() {
      // txt.value 요소 가져오기
      const input = txt.value;

      // 수정, 삭제 button 요소 생성하기
      const btnMod = document.createElement("button");
      const btnDel = document.createElement("button");
      btnMod.textContent = "수정";
      btnDel.textContent = "삭제";

      // input이 빈 값일 경우 add 함수 종료
      if (!input) {
        alert("할 일을 입력해 주세요!");
        return;
      }
      // li, checkbox, span 요소 생성하기
      const li = document.createElement("li");
      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      const span = document.createElement("span");

      // input 값을 span 요소에 저장하기
      span.textContent = input + " ";

      // checkbox, span 요소를 li의 자식 요소에 추가
      // btnMod, btnDel 요소도 li의 자식 요소에 추가
      li.append(checkbox, span);
      li.append(btnMod, btnDel);

      // li 요소를 list 요소의 자식으로 추가하기
      list.append(li);

      // 수정 이벤트
      btnMod.addEventListener("click", () => {
        const mod = prompt("수정할 내용을 입력해 주세요.");
        // mod가 빈 값일 경우 수정 에러 메시지 출력
        if (mod.length === 0) {
          alert("빈 값은 입력할 수 없습니다.");
          return;
        } 

        // li의 span 요소 수정하기
        li.querySelector("span").textContent = mod + " ";
      });

      // 삭제 이벤트
      btnDel.addEventListener("click", () => {
        // 삭제 여부 묻기
        const ok = confirm("정말 삭제하시겠습니까?");
        if (!ok) return;
        li.remove();
        checkEmpty()
      });

      // checkbox 체크 여부
      checkbox.addEventListener("change", () => {
        if (checkbox.checked) {
          span.style.color = "gray";
          span.style.textDecoration = "line-through";
        } else {
          span.style.color = "black";
          span.style.textDecoration = "none";
        }
      });

      // txt.value 초기화
      txt.value = "";

      // txt.focus() -> 추가 후에 바로 입력창을 사용할 수 있도록
      txt.focus();

      checkEmpty();
    }

    // 이벤드 핸들러 생성
    btnAdd.addEventListener("click", add);
    txt.addEventListener("keydown", (e) => {
      if (e.key === "Enter") add();
    });

    const p = document.createElement("p");
    p.textContent = "할 일이 없습니다.";
    document.body.append(p);

    // To-do가 하나도 없을 경우
    function checkEmpty() {
      p.style.display = list.children.length === 0 ? "block" : "none" ;
    }

    // 전체, 진행중, 완료 필터 설정
    function filterSelect() {
      // 선택
      const selected = document.querySelector("input[name='filter']:checked").value;
      const todos = list.querySelectorAll("li");

      todos.forEach((t) => {
        const checked = t.querySelector("input[type='checkbox']:checked");

        // 선택된 filter에 따라 출력을 다르게!
        if (selected === "all") {
          t.style.display = "";
        } else if (selected === "ing") {
          t.style.display = (checked !== null) ? "none" : "";
        } else if (selected === "complete") {
          t.style.display = (checked !== null) ? "" : "none";
        }
      });
    }

    // 필터에 대한 이벤트 핸들러
    filters.forEach((radio) => {
      radio.addEventListener("change", filterSelect);
    });
  </script>
</body>
</html>